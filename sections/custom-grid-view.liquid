{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }
  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}

<div class="section-{{ section.id }}-padding">
  <div class="{{ section.settings.section-checkbox }}">
    <div class="custom-section-product">
      <div class="custom-section-text">
        <h2>{{ section.settings['section-heading-text'] }}</h2>
      </div>
      <div class="custom-product-grid" id="section-{{ section.id }}">
        {% for block in section.blocks %}
          {% assign product = all_products[block.settings['custom-product']] %}
          {% if product %}
            <div class="product-img-wrapper" id="block-{{ block.id }}" data-product-id="{{ product.id }}" data-product-title="{{ product.title }}" data-product-description="{{ product.description | strip_html | escape }}" data-product-image="{{ product.featured_image | image_url }}">
              {{ product.featured_image | image_url: width: 433, height: 444 | image_tag: class: 'custom-product-img' }}
              <button class="open-popup">
                <span class="svg-wrapper">{{ 'icon-plus-custom.svg' | inline_asset_content }}</span>
              </button>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</div>

<div class="product-popup hidden">
  <div class="popup-content">
    <span class="close-popup">&times;</span>
    <div class="product-info">
      <img src="" class="popup-product-img" alt="Product Image">
      <h2 class="popup-product-title"></h2>
      <p class="popup-product-description"></p>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const popup = document.querySelector(".product-popup");
    const closePopupBtn = document.querySelector(".close-popup");
    const openPopupBtns = document.querySelectorAll(".open-popup");
    const popupTitle = popup.querySelector(".popup-product-title");
    const popupImg = popup.querySelector(".popup-product-img");
    const popupDescription = popup.querySelector(".popup-product-description");

    openPopupBtns.forEach(button => {
      button.addEventListener("click", function() {
        const productBlock = this.closest(".product-img-wrapper");
        const productTitle = productBlock.dataset.productTitle;
        const productImg = productBlock.dataset.productImage;
        const productDescription = productBlock.dataset.productDescription;

        popupTitle.textContent = productTitle;
        popupImg.src = productImg;
        popupDescription.textContent = productDescription;

        popup.classList.remove("hidden");
      });
    });

    closePopupBtn.addEventListener("click", function() {
      popup.classList.add("hidden");
    });
  });
</script>
